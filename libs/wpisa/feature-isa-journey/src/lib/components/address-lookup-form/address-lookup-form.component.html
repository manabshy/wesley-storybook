<form [formGroup]="form">
  <wes-form-field>
    <wes-label data-test="lblFindAddressPostcode">{{
      pageContent.addressDetails.postcode.inputLabel
    }}</wes-label>
    <input
      wesInput
      type="text"
      formControlName="postcode"
      autocomplete="postal-code"
      data-test="txtFindAddressPostcode"
      #postcodeInput
    />
    <wes-error *ngIf="isFieldInvalid('postcode')">
      <wes-form-field-error>
        {{ pageContent.addressDetails.postcode.inputError }}
      </wes-form-field-error>
    </wes-error>
  </wes-form-field>
  <button
    class="wes-button wes-button-primary"
    type="button"
    data-test="btnFindAddress"
    [wesButtonLoader]="findingAddress"
    (click)="findAddress(postcodeInput.value)"
  >
    {{ pageContent.addressDetails.findAddress }}
  </button>

  <div class="form-group" *ngIf="addressList.length > 0">
    <label for="address-list" data-test="lblAddressList">{{
      pageContent.addressDetails.selectYourAddress.inputLabel
    }}</label>
    <select
      formControlName="selectedAddressId"
      name="address-list"
      class="form-control"
      (change)="onSelectedAddress($event)"
      data-test="ddAddressList"
    >
      <option *ngFor="let address of addressList" [value]="address.moniker">{{
        address.singleLine
      }}</option>
    </select>

    <ng-container *ngIf="isFieldInvalid('selectedAddressId')">
      <span>
        {{ pageContent.addressDetails.selectYourAddress.inputError }}
      </span>
    </ng-container>
  </div>

  <p>
    <ng-container *ngIf="addressList.length > 0">{{
      pageContent.addressDetails.cantSeeAddressLabel
    }}</ng-container>
    <button
      type="button"
      class="wes-button wes-button-link"
      (click)="onShowManualAddress()"
      data-test="btnEnterAddressManually"
    >
      {{ pageContent.addressDetails.enterAddressManuallyLabel }}
    </button>
  </p>
</form>
<!-- Lookup Valid {{ form.valid }} -->
