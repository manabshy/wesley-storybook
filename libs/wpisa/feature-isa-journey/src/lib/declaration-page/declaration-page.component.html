<a
  class="wes-link wes-text-s mb-3 mb-md-4 d-inline-block"
  [routerLink]="investmentOptionLink"
  data-test="lnkBackToInvestmentOptions"
  >{{ pageContent.backButtonLabel }}</a
>
<h1>{{ pageContent.heading }}</h1>
<div [innerHtml]="pageContent.summary"></div>

<!-- <pre
  >{{ selectedInvestmentOption$ | async | json }}
  >{{ investmentCardViewModelData$ | async | json }}
  >{{ directDebitContent$ | async | json }}
  >{{ personalDetailsContent$ | async | json }}
</pre> -->
<ng-container *ngIf="investmentCardViewModelData$ | async as investment">
  <div class="wes-investment-card">
    <div class="wes-card-title">
      <div>{{ pageContent.yourInvestmentLabel }}</div>
      <div>
        <a
          class="wes-link"
          [routerLink]="yourInvestmentLink"
          data-test="lnkBackToYourInvestment"
          >{{ pageContent.editLabel }}</a
        >
      </div>
    </div>
    <div class="wes-card-body">
      <div *ngIf="investment.showLumpSum">
        <span>{{ investment.lumpSumPayment.label }}</span
        ><span>{{ investment.lumpSumPayment.value }}</span>
      </div>
      <div *ngIf="investment.showMonthly">
        <span>{{ investment.monthlyPayment.label }}</span
        ><span
          >{{ investment.monthlyPayment.value }}
          {{ pageContent.perMonthLabel }}</span
        >
      </div>
      <div>
        <span>{{ investment.total.label }}</span
        ><span>{{ investment.total.value }}</span>
      </div>
    </div>
  </div>
</ng-container>

<ng-container *ngIf="directDebitContent$ | async as dd">
  <div class="wes-investment-card">
    <div class="wes-card-title">
      <div>{{ pageContent.directDebitLabel }}</div>
      <div>
        <a
          class="wes-link"
          [routerLink]="yourInvestmentLink"
          data-test="lnkBackToDD"
          >{{ pageContent.editLabel }}</a
        >
      </div>
    </div>
    <div class="wes-card-body">
      <div>
        <span>{{ dd.accountNumber.label }}</span
        ><span>{{ dd.accountNumber.value }}</span>
      </div>
      <div>
        <span>{{ dd.sortCode.label }}</span
        ><span>{{ dd.sortCode.value }}</span>
      </div>
    </div>
  </div>
</ng-container>

<ng-container *ngIf="personalDetailsContent$ | async as personalDetails">
  <div class="wes-investment-card">
    <div class="wes-card-title">
      <div>{{ pageContent.yourDetailsLabel }}</div>
      <div>
        <a
          class="wes-link"
          [routerLink]="yourDetailsLink"
          data-test="lnkBackToPersonalDetails"
          >{{ pageContent.editLabel }}</a
        >
      </div>
    </div>
    <div class="wes-card-body">
      <div>
        <span>{{ personalDetails.name.label }}</span
        ><span>{{ personalDetails.name.value }}</span>
      </div>
      <div>
        <span>{{ personalDetails.dob.label }}</span
        ><span>{{ personalDetails.dob.value }}</span>
      </div>
      <div>
        <span>{{ personalDetails.profession.label }}</span
        ><span>{{ personalDetails.profession.value }}</span>
      </div>
      <div>
        <span>{{ personalDetails.nationality.label }}</span
        ><span>{{ personalDetails.nationality.value }}</span>
      </div>
      <div>
        <span>{{ personalDetails.emailAddress.label }}</span
        ><span>{{ personalDetails.emailAddress.value }}</span>
      </div>
      <div>
        <span>{{ personalDetails.phoneNumber.label }}</span
        ><span>{{ personalDetails.phoneNumber.value }}</span>
      </div>
      <div>
        <span>{{ personalDetails.homeAddress.label }}</span
        ><span>{{ personalDetails.homeAddress.value }}</span>
      </div>
    </div>
  </div>
</ng-container>

<h4>{{ pageContent.isaLabel }}</h4>
<div [innerHtml]="pageContent.isaRules"></div>
<div [innerHtml]="pageContent.adviceContent"></div>
<hr class="my-5" />
<form [formGroup]="form" (ngSubmit)="onSubmit()" wesInvalidControlScroll>
  <wes-checkbox
    formControlName="authorise"
    class="d-block mb-1"
    [ngClass]="{ 'wes-checkbox-error': isFieldInvalid('authorise') }"
    labelTestId="lblAuthorise"
    inputTestId="cbAuthorise"
    ><strong>{{
      pageContent.authoriseCheckbox.inputLabel
    }}</strong></wes-checkbox
  >
  <wes-form-field-error *ngIf="isFieldInvalid('authorise')">{{
    pageContent.authoriseCheckbox.inputError
  }}</wes-form-field-error>

  <div
    class="t-and-c-list mb-6"
    [innerHtml]="pageContent.authoriseContent"
  ></div>

  <wes-checkbox
    formControlName="declaration"
    class="d-block mb-1"
    [ngClass]="{ 'wes-checkbox-error': isFieldInvalid('declaration') }"
    labelTestId="lblDeclaration"
    inputTestId="cbDeclaration"
    ><strong>{{
      pageContent.declarationCheckbox.inputLabel
    }}</strong></wes-checkbox
  >
  <wes-form-field-error *ngIf="isFieldInvalid('declaration')">
    <span>
      {{ pageContent.declarationCheckbox.inputError }}
    </span>
  </wes-form-field-error>
  <div class="t-and-c-list mb-5" [innerHtml]="pageContent.content"></div>

  <div [innerHtml]="pageContent.confirmContent"></div>
  <button
    class="wes-button wes-button-primary d-block w-100 w-md-auto mt-5 mt-md-6"
    type="submit"
    data-test="btnConfirm"
  >
    {{ pageContent.nextButtonLabel }}
  </button>
</form>
