<a
  class="wes-link wes-text-s mb-3 mb-md-4 d-inline-block"
  [routerLink]="investmentOptionLink"
  data-test="lnkBackToInvestmentOptions"
  >{{ pageContent.backButtonLabel }}</a
>
<h1>{{ pageContent.heading }}</h1>
<div class="mb-6 mb-md-7 mb-lg-8" [innerHtml]="pageContent.summary"></div>

<ng-container *ngIf="investmentCardViewModelData$ | async as investment">
  <div
    class="wes-investment-card wes-bg-solid-grey-50 mb-3 mb-md-4 p-3 px-lg-4"
  >
    <div class="wes-card-title">
      <h2 class="wes-h4">{{ pageContent.yourInvestmentLabel }}</h2>
      <div>
        <a
          class="wes-link wes-text-s"
          [routerLink]="yourInvestmentLink"
          data-test="lnkBackToYourInvestment"
          >{{ pageContent.editLabel }}</a
        >
      </div>
    </div>
    <div class="wes-card-body">
      <div *ngIf="investment.showLumpSum">
        <p>{{ investment.lumpSumPayment.label }}</p>
        <p class="wes-h2">
          <strong>{{ investment.lumpSumPayment.value }}</strong>
        </p>
      </div>
      <div *ngIf="investment.showMonthly">
        <p>{{ investment.monthlyPayment.label }}</p>
        <span>
          <span class="wes-h2"
            ><strong>{{ investment.monthlyPayment.value }}</strong></span
          >
          {{ pageContent.perMonthLabel }}
        </span>
      </div>
      <div class="investment-total w-100">
        <img src="assets/icons/svg/icon-calculator.svg" />
        <p>
          {{ investment.total.label }}
          <strong>{{ investment.total.value }}</strong>
        </p>
      </div>
    </div>
  </div>
</ng-container>

<ng-container *ngIf="directDebitContent$ | async as dd">
  <div
    class="wes-investment-card wes-bg-solid-grey-50 mb-3 mb-md-4 p-3 px-lg-4"
  >
    <div class="wes-card-title">
      <h2 class="wes-h4">{{ pageContent.directDebitLabel }}</h2>
      <div>
        <a
          class="wes-link wes-text-s"
          [routerLink]="yourInvestmentLink"
          data-test="lnkBackToDD"
          >{{ pageContent.editLabel }}</a
        >
      </div>
    </div>
    <div class="wes-card-body">
      <div>
        <span>{{ dd.accountNumber.label }}</span
        ><span>{{ dd.accountNumber.value }}</span>
      </div>
      <div>
        <span>{{ dd.sortCode.label }}</span
        ><span>{{ dd.sortCode.value }}</span>
      </div>
    </div>
  </div>
</ng-container>

<ng-container *ngIf="personalDetailsContent$ | async as personalDetails">
  <div
    class="wes-investment-card wes-bg-solid-grey-50 mb-3 mb-md-4 p-3 px-lg-4"
  >
    <div class="wes-card-title">
      <h2 class="wes-h4">{{ pageContent.yourDetailsLabel }}</h2>
      <div>
        <a
          class="wes-link wes-text-s"
          [routerLink]="yourDetailsLink"
          data-test="lnkBackToPersonalDetails"
          >{{ pageContent.editLabel }}</a
        >
      </div>
    </div>
    <div class="wes-card-body">
      <div>
        <span>{{ personalDetails.name.label }}</span
        ><span>{{ personalDetails.name.value }}</span>
      </div>
      <div>
        <span>{{ personalDetails.dob.label }}</span
        ><span>{{ personalDetails.dob.value }}</span>
      </div>
      <div>
        <span>{{ personalDetails.profession.label }}</span
        ><span>{{ personalDetails.profession.value }}</span>
      </div>
      <div>
        <span>{{ personalDetails.nationality.label }}</span
        ><span>{{ personalDetails.nationality.value }}</span>
      </div>
      <div>
        <span>{{ personalDetails.emailAddress.label }}</span
        ><span>{{ personalDetails.emailAddress.value }}</span>
      </div>
      <div>
        <span>{{ personalDetails.phoneNumber.label }}</span
        ><span>{{ personalDetails.phoneNumber.value }}</span>
      </div>
      <div>
        <span>{{ personalDetails.homeAddress.label }}</span
        ><span>{{ personalDetails.homeAddress.value }}</span>
      </div>
    </div>
  </div>
</ng-container>

<h4>{{ pageContent.isaLabel }}</h4>
<div [innerHtml]="pageContent.isaRules"></div>
<div [innerHtml]="pageContent.adviceContent"></div>
<hr class="my-5" />
<form [formGroup]="form" (ngSubmit)="onSubmit()" wesInvalidControlScroll>
  <wes-checkbox
    formControlName="authorise"
    class="d-block mb-1"
    [ngClass]="{ 'wes-checkbox-error': isFieldInvalid('authorise') }"
    labelTestId="lblAuthorise"
    inputTestId="cbAuthorise"
    ><strong>{{
      pageContent.authoriseCheckbox.inputLabel
    }}</strong></wes-checkbox
  >
  <wes-form-field-error *ngIf="isFieldInvalid('authorise')">{{
    pageContent.authoriseCheckbox.inputError
  }}</wes-form-field-error>

  <div
    class="t-and-c-list mb-6"
    [innerHtml]="pageContent.authoriseContent"
  ></div>

  <wes-checkbox
    formControlName="declaration"
    class="d-block mb-1"
    [ngClass]="{ 'wes-checkbox-error': isFieldInvalid('declaration') }"
    labelTestId="lblDeclaration"
    inputTestId="cbDeclaration"
    ><strong>{{
      pageContent.declarationCheckbox.inputLabel
    }}</strong></wes-checkbox
  >
  <wes-form-field-error *ngIf="isFieldInvalid('declaration')">
    <span>
      {{ pageContent.declarationCheckbox.inputError }}
    </span>
  </wes-form-field-error>
  <div class="t-and-c-list mb-5" [innerHtml]="pageContent.content"></div>

  <div [innerHtml]="pageContent.confirmContent"></div>
  <button
    class="wes-button wes-button-primary d-block w-100 w-md-auto mt-5 mt-md-6"
    type="submit"
    data-test="btnConfirm"
  >
    {{ pageContent.nextButtonLabel }}
  </button>
</form>
