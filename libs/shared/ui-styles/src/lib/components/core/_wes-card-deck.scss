////
/// Wesleyan Card Deck (Full Width) Component
////

/// Combine quantity queries
@mixin exactlyTwoOrFour() {
  @include exactly(2) {
    @content;
  }

  @include exactly(4) {
    @content;
  }
}

/// Apply styling to card features when in 2 column layout
@mixin isTwoCol() {
  @at-root {
    $bg: &;

    .wes-card-deck__deck-item {
      @include exactlyTwoOrFour {
        #{$bg} {
         @content;
        }
      }
    }
  }
}


.wes-card-deck {
  @include wes-make-full-width-component;

  padding-top: rem(24px);
  padding-bottom: rem(24px);

  @include media-breakpoint-up(md) {
    padding-top: rem(32px);
    padding-bottom: rem(32px);
  }

  @include media-breakpoint-up(lg) {
    padding-top: rem(48px);
    padding-bottom: rem(48px);
  }

  &.wes-card-deck--grey {
    background-color: $global-colour-grey-50;
  }

  &__wrapper {
    @include wes-make-container;
  }

  &__header {
    @include wes-make-row;

    margin-bottom: rem(32px);

    @include media-breakpoint-up(md) {
      margin-bottom: rem(48px);
    }

    @include media-breakpoint-up(xl) {
      margin-bottom: rem(64px);
    }
  }

  &__header-content {
    @include wes-make-col-ready;

    @include media-breakpoint-up(md) {
      @include make-col(11);
    }

    @include media-breakpoint-up(lg) {
      @include make-col(9);
    }

    @include media-breakpoint-up(xl) {
      @include make-col(7);
    }
  }

  &__title {
    @extend .wes-h2;

    font-weight: 400;
    margin-bottom: 0;
  }

  &__message {
    @extend .wes-rich-text-scope;

    margin-top: rem(16px);
  }

  &__deck {
    @include wes-make-row;
  }

  &__deck-item {
    @include wes-make-col-ready;

    @include media-breakpoint-down(md) {
      & + & {
        margin-top: rem(24px);
      }
    }

    @include media-breakpoint-up(lg) {
      @include make-col(4);

      @include exactlyTwoOrFour {
        @include make-col(6);
      }

      display: flex;

      &:nth-child(n+3) + &,
      &:nth-child(3):nth-last-child(2) {
        margin-top: rem(24px);
      }
    }

    @include media-breakpoint-up(xl) {
      &:nth-child(n+3) + &,
      &:nth-child(3):nth-last-child(2) {
        margin-top: rem(32px);
      }
    }

    @at-root {
      .wes-card-deck--icons & + & {
        @include media-breakpoint-down(sm) {
          margin-top: rem(48px);
        }

        @include media-breakpoint-only(md) {
          margin-top: rem(56px);
        }
      }

      .wes-card-deck--icons & {
        @include media-breakpoint-only(md) {
          @include make-col(11);
        }

        @include media-breakpoint-up(lg) {
          &:nth-child(n+3) + .wes-card-deck__deck-item,
          &:nth-child(3):nth-last-child(2) {
            margin-top: rem(64px);
          }
        }

        @include media-breakpoint-up(xl) {
          &:nth-child(n+3) + .wes-card-deck__deck-item,
          &:nth-child(3):nth-last-child(2) {
            margin-top: rem(72px);
          }
        }
      }
    }
  }

  &__card {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    
    &-bg {
      height: rem(192px);
      background-position: center center;
      background-size: cover;
      background-repeat: no-repeat;

      @include media-breakpoint-up(md) {
        height: rem(384px);
      }

      @include media-breakpoint-up(lg) {
        height: rem(160px); // 3col

        @include isTwoCol {
          height: rem(248px); // 2col
        }
      }

      @include media-breakpoint-up(xl) {
        height: rem(208px); // 3col

        @include isTwoCol {
          height: rem(320px); // 2col
        }
      }

      @at-root {
        .wes-card-deck--icons & {
          display: none;
        }
      }
    }

    &-icon {
      display: none;
      margin-bottom: rem(24px);

      @at-root {
        .wes-card-deck--icons & {
          display: block;
        }
      }
    }

    &-body {
      background-color: $global-colour-grey-50;
      padding: rem(32px) rem(16px);

      @include media-breakpoint-up(md) {
        padding: rem(40px) rem(32px);
      }

      @include media-breakpoint-up(lg) {
        padding: rem(40px) rem(32px);
        display: flex;
        flex-direction: column;
        flex-grow: 1;
      }

      @at-root {
        .wes-card-deck--grey & {
          background-color: $global-colour-white;
        }

        .wes-card-deck--icons & {
          background-color: transparent;
          padding: 0;

          @include media-breakpoint-up(lg) {
            padding-right: rem(32px);
          }
        }
      }
    }

    &-title {
      @extend .wes-text-l;
      @extend .wes-text-semi-bold;

      margin: 0;
    }

    &-message {
      @extend .wes-text-s;

      margin-top: rem(16px);
      flex-grow: 1;
    }
  
    &-footer {
      margin-top: rem(24px);

      @include media-breakpoint-up(md) {
        margin-top: rem(32px);
      }
    }

    &-cta {
      @extend .wes-link;
      @extend .wes-text-s;
    }
  }
}
  